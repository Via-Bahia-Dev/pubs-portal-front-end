<%= stylesheet_link_tag "templates.css" %>

<div class="page-header">
	<h1>Publishing Portal</h1>
</div>


<% unless signed_in? %>
	<div class="row">
		<div class="col-md-offset-4 col-md-4 col-xs-offset-2 col-xs-8">
			<%= render partial: 'sessions/new' %>
		</div>
	</div>
<% else %>
	<div class="row">
		<h2 id="welcome-header" class="col-md-4 col-xs-8"> Welcome <%= current_user.first_name %> <%= current_user.last_name %></h2>
		<div class="col-md-2 col-xs-4">
			<% if can? :create, Template %>
				<%= link_to "Upload Template", new_template_path, class: "btn btn-primary" %>
			<% end %>
		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<h3>Choose a template to base your publication request on</h3>
		</div>
	</div>

	<div class="row wall" id="templates-wall">
		<% @templates.each do |template| %>
			<div class="template-cell">
				<%= link_to(image_tag(template['image_medium'], class: "img-thumbnail"), new_publication_request_path(:template_id => template['id'])) %>
			</div>
		<% end %>
	</div>

	<script>
		$(document).ready(function() {
			var wall = new freewall("#templates-wall");
			wall.reset({
				selector: '.template-cell',
				animate: true,
				cellW: 20,
				cellH: 200,
				onResize: function() {
					wall.fitWidth();
				}
			});
			wall.fitWidth();

			$(window).trigger("resize");
		});
	
	</script>
<% end %>


